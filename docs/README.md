# FermiNeuT å®ç°æ–‡æ¡£ç´¢å¼•

æ¬¢è¿é˜…è¯» FermiNeuT å®Œæ•´å®ç°æ–‡æ¡£ã€‚æœ¬é¡¹ç›®ä½¿ç”¨å˜åˆ†è’™ç‰¹å¡æ´›ï¼ˆVMCï¼‰æ–¹æ³•å’Œè´¹ç±³å­ç¥ç»ç½‘ç»œç²¾ç¡®è®¡ç®—æ°´åˆ†å­çš„ç”µå­ç»“æ„ã€‚

## ğŸ“š æ–‡æ¡£ç»“æ„

### æ ¸å¿ƒæ–‡æ¡£

1. **[Stage 1 å®Œæ•´æ–‡æ¡£](./Stage1_Complete_Documentation.md)** ~43 KB
   - æ¦‚è¿°å’ŒæŠ€æœ¯æ ˆ
   - SimpleFermiNet ç½‘ç»œæ¶æ„
   - ç‰©ç†è®¡ç®—å±‚è¯¦è§£
   - MCMC é‡‡æ ·å™¨å®ç°
   - VMCTrainer è®­ç»ƒå™¨
   - Hâ‚‚ åˆ†å­é…ç½®
   - è®­ç»ƒç»“æœå’Œåˆ†æ
   - å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

2. **[Stage2 å®Œæ•´æ–‡æ¡£](./Stage2_Complete_Documentation.md)** ~58 KB
   - Stage 2 æ‰©å±•ç‰¹æ€§æ¦‚è¿°
   - ExtendedFermiNet ç½‘ç»œæ¶æ„
   - å¤šè¡Œåˆ—å¼å®ç°ç»†èŠ‚
   - Jastrow ç›¸å…³å› å­
   - æ®‹å·®è¿æ¥å±‚
   - å­¦ä¹ ç‡è°ƒåº¦å™¨
   - ExtendedTrainer è®­ç»ƒå™¨
   - è®­ç»ƒç»“æœå’Œæ•°å€¼ç¨³å®šæ€§åˆ†æ
   - ç¨³å®šåŒ–æ–¹æ¡ˆ

### æŠ€æœ¯æ–‡æ¡£

3. **[ä»£ç ç»“æ„ä¸ API](./Code_Structure_and_API.md)** ~48 KB
   - å®Œæ•´æ–‡ä»¶æ ‘ç»“æ„
   - æ¨¡å— API æ–‡æ¡£
   - æ•°æ®æµç¨‹å›¾
   - æ¨¡å—é›†æˆæŒ‡å—
   - æ‰©å±•æ€§æŒ‡å—

4. **[ç®—æ³•ä¸å…¬å¼](./Algorithms_and_Formulas.md)** ~44 KB
   - æ³¢å‡½æ•°ç†è®ºåŸºç¡€
   - èƒ½é‡å…¬å¼æ¨å¯¼
   - å˜åˆ†åŸç†è¯¦è§£
   - MCMC ç®—æ³•å®ç°
   - ä¼˜åŒ–ç®—æ³•å…¬å¼
   - æ•°å€¼ç¨³å®šæ€§æŠ€å·§

5. **[æµ‹è¯•ä¸ä½¿ç”¨æŒ‡å—](./Testing_and_Usage_Guide.md)** ~48 KB
   - å…¥é—¨å’Œå¿«é€Ÿå¼€å§‹
   - æµ‹è¯•æŒ‡å—
   - è®­ç»ƒæŒ‡å—
   - è°ƒè¯•æŒ‡å—
   - ç»“æœåˆ†æ
   - æœ€ä½³å®è·µ

### æ€§èƒ½åˆ†ææ–‡æ¡£

6. **[æ€§èƒ½åˆ†æ - RTX 3060 6G](./Performance_Analysis_RTX3060.md)** ~20 KB
   - GPU vs CPU è®¡ç®—å¯†é›†åº¦åˆ†æ
   - æ€§èƒ½ç“¶é¢ˆè¯†åˆ«
   - ä¼˜åŒ–æ–¹æ¡ˆè¯¦ç»†è¯´æ˜
   - é¢„æœŸæ€§èƒ½æå‡æ•°æ®

---

## ğŸš€ å¿«é€Ÿå¯¼èˆª

### æˆ‘æƒ³äº†è§£...

#### é¡¹ç›®æ¦‚è§ˆ
â†’ é˜…è¯» [Stage 1 å®Œæ•´æ–‡æ¡£](./Stage1_Complete_Documentation.md) çš„ **æ¦‚è¿°** éƒ¨åˆ†

#### ç½‘ç»œæ¶æ„
â†’ é˜…è¯» [Stage 1 å®Œæ•´æ–‡æ¡£](./Stage1_Complete_Documentation.md) çš„ **ç½‘ç»œæ¶æ„** ç« èŠ‚
â†’ é˜…è¯» [Stage 2 å®Œæ•´æ–‡æ¡£](./Stage2_Complete_Documentation.md) çš„ **æ‰©å±•ç½‘ç»œæ¶æ„** ç« èŠ‚

#### æ•°å­¦åŸç†
â†’ é˜…è¯» [ç®—æ³•ä¸å…¬å¼](./Algorithms_and_Formulas.md) çš„ **æ³¢å‡½æ•°ç†è®ºåŸºç¡€** å’Œ **èƒ½é‡å…¬å¼** ç« èŠ‚

#### å¦‚ä½•è¿è¡Œè®­ç»ƒ
â†’ é˜…è¯» [æµ‹è¯•ä¸ä½¿ç”¨æŒ‡å—](./Testing_and_Usage_Guide.md) çš„ **å…¥é—¨** å’Œ **è®­ç»ƒæŒ‡å—** ç« èŠ‚

#### è°ƒè¯•é—®é¢˜
â†’ é˜…è¯» [æµ‹è¯•ä¸ä½¿ç”¨æŒ‡å—](./Testing_and_Usage_Guide.md) çš„ **è°ƒè¯•æŒ‡å—** ç« èŠ‚
â†’ é˜…è¯» [Stage 1 å®Œæ•´æ–‡æ¡£](./Stage1_Complete_Documentation.md) çš„ **å·²çŸ¥é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ** ç« èŠ‚

#### æ€§èƒ½ä¼˜åŒ–
â†’ é˜…è¯» [æ€§èƒ½åˆ†æ - RTX 3060 6G](./Performance_Analysis_RTX3060.md)
â†’ äº†è§£ GPU è®¡ç®—å¯†é›†ç‰¹æ€§
â†’ æŸ¥çœ‹ä¼˜åŒ–æ–¹æ¡ˆå’Œé¢„æœŸæå‡

#### ç†è§£ä»£ç 
â†’ é˜…è¯» [ä»£ç ç»“æ„ä¸ API](./Code_Structure_and_API.md) çš„ **æ¨¡å— API æ–‡æ¡£** ç« èŠ‚

---

## ğŸ“Š å¼€å‘é˜¶æ®µ

### Stage 1ï¼šç®€åŒ–å®ç° âœ… å®Œæˆ
- **ç›®æ ‡**ï¼šå¿«é€ŸéªŒè¯æ¦‚å¿µ
- **ç²¾åº¦**ï¼š100-500 mHa
- **çŠ¶æ€**ï¼šâœ… è®­ç»ƒæˆåŠŸï¼Œèƒ½é‡æ”¶æ•›
- **æ–‡æ¡£**ï¼š[Stage 1 å®Œæ•´æ–‡æ¡£](./Stage1_Complete_Documentation.md)

### Stage 2ï¼šæ‰©å±•å®ç° âš ï¸ æ ¸å¿ƒå®Œæˆï¼Œéœ€ç¨³å®šåŒ–
- **ç›®æ ‡**ï¼šæé«˜ç²¾åº¦åˆ° 10-20 mHa
- **ç‰¹æ€§**ï¼šå¤šè¡Œåˆ—å¼ã€æ®‹å·®è¿æ¥ã€å­¦ä¹ ç‡è°ƒåº¦
- **çŠ¶æ€**ï¼šâš ï¸ å®ç°å®Œæˆï¼Œè®­ç»ƒå­˜åœ¨æ•°å€¼ä¸ç¨³å®š
- **æ–‡æ¡£**ï¼š[Stage 2 å®Œæ•´æ–‡æ¡£](./Stage2_Complete_Documentation.md)

### æ€§èƒ½ä¼˜åŒ– ğŸ”§ è¿›è¡Œä¸­
- **ç›®æ ‡**ï¼šè§£å†³æ€§èƒ½ç“¶é¢ˆï¼ˆ150s/epoch â†’ 0.5-1s/epochï¼‰
- **ä¼˜åŒ–é‡ç‚¹**ï¼š
  1. ä¿®å¤èƒ½é‡è®¡ç®—ï¼ˆä½¿ç”¨ Hessianï¼‰
  2. æ‰¹é‡ vmap å¹¶è¡ŒåŒ–
  3. å¢å¤§æ‰¹æ¬¡å¤§å°ï¼ˆ128 â†’ 512ï¼‰
  4. JIT ç¼–è¯‘å…³é”®å‡½æ•°
- **é¢„æœŸæå‡**ï¼š50-300x
- **æ–‡æ¡£**ï¼š[æ€§èƒ½åˆ†æ - RTX 3060 6G](./Performance_Analysis_RTX3060.md)

### Stage 3ï¼šå®Œæ•´å®ç° ğŸ“‹ å¾…å¼€å‘
- **ç›®æ ‡**ï¼šåŒ–å­¦ç²¾åº¦ 1 mHa
- **ç‰¹æ€§**ï¼šKFAC ä¼˜åŒ–å™¨ã€å®Œæ•´ç½‘ç»œã€è‡ªé€‚åº” MCMC
- **çŠ¶æ€**ï¼šğŸ“‹ æ¶æ„å·²è®¾è®¡ï¼Œå¾…å®ç°
- **æ–‡æ¡£**ï¼šå‚è€ƒ [Stage 2 å®Œæ•´æ–‡æ¡£](./Stage2_Complete_Documentation.md) çš„ Stage 3 è®¡åˆ’ç« èŠ‚

---

## ğŸ”§ å¸¸è§ä»»åŠ¡

### æ–°ç”¨æˆ·å…¥é—¨
1. é˜…è¯» [æµ‹è¯•ä¸ä½¿ç”¨æŒ‡å—](./Testing_and_Usage_Guide.md) çš„ **å…¥é—¨** ç« èŠ‚
2. è¿è¡Œç¬¬ä¸€ä¸ªè®­ç»ƒï¼š`python train_optimized.py`
3. è§‚å¯Ÿè®­ç»ƒè¾“å‡ºå’Œèƒ½é‡æ”¶æ•›

### è°ƒè¯•è®­ç»ƒé—®é¢˜
1. æŸ¥çœ‹ [æµ‹è¯•ä¸ä½¿ç”¨æŒ‡å—](./Testing_and_Usage_Guide.md) çš„ **è°ƒè¯•æŒ‡å—**
2. å‚è€ƒ [Stage 1 å®Œæ•´æ–‡æ¡£](./Stage1_Complete_Documentation.md) çš„å·²çŸ¥é—®é¢˜
3. ä½¿ç”¨æµ‹è¯•è„šæœ¬éªŒè¯ç»„ä»¶ï¼š`python test_network_stability.py`

### æ€§èƒ½é—®é¢˜ï¼ˆå½“å‰é‡è¦ï¼‰
1. é˜…è¯» [æ€§èƒ½åˆ†æ - RTX 3060 6G](./Performance_Analysis_RTX3060.md)
2. æŸ¥çœ‹æ€§èƒ½ç“¶é¢ˆåˆ†æç« èŠ‚
3. å®æ–½é˜¶æ®µ 1 ä¼˜åŒ–ï¼šä¿®å¤èƒ½é‡è®¡ç®—ï¼ˆé¢„æœŸ 100x æå‡ï¼‰
4. å®æ–½é˜¶æ®µ 2 ä¼˜åŒ–ï¼šå¢å¤§æ‰¹æ¬¡ï¼ˆé¢„æœŸ 2-4x æå‡ï¼‰

### ç†è§£ç®—æ³•åŸç†
1. é˜…è¯» [ç®—æ³•ä¸å…¬å¼](./Algorithms_and_Formulas.md) çš„ **æ³¢å‡½æ•°ç†è®ºåŸºç¡€**
2. å­¦ä¹ èƒ½é‡å…¬å¼æ¨å¯¼
3. ç†è§£ MCMC é‡‡æ ·æœºåˆ¶

### å¼€å‘æ–°åŠŸèƒ½
1. æŸ¥çœ‹ [ä»£ç ç»“æ„ä¸ API](./Code_Structure_and_API.md) çš„ **æ‰©å±•æ€§æŒ‡å—**
2. å‚è€ƒ [Stage 2 å®Œæ•´æ–‡æ¡£](./Stage2_Complete_Documentation.md) çš„æ‰©å±•ç‰¹æ€§å®ç°
3. éµå¾ªä»£ç é£æ ¼å’Œæ¶æ„æ¨¡å¼

---

## ğŸ“ æ–‡ä»¶ç»“æ„å‚è€ƒ

```
FermiNet/
â”œâ”€â”€ docs/                           # æ–‡æ¡£ç›®å½•ï¼ˆæœ¬ç›®å½•ï¼‰
â”‚   â”œâ”€â”€ README.md                    # æœ¬æ–‡ä»¶ï¼šæ–‡æ¡£ç´¢å¼•
â”‚   â”œâ”€â”€ Stage1_Complete_Documentation.md  # Stage 1 å®Œæ•´æ–‡æ¡£
â”‚   â”œâ”€â”€ Stage2_Complete_Documentation.md  # Stage 2 å®Œæ•´æ–‡æ¡£
â”‚   â”œâ”€â”€ Code_Structure_and_API.md          # ä»£ç ç»“æ„ä¸ API
â”‚   â”œâ”€â”€ Algorithms_and_Formulas.md         # ç®—æ³•ä¸å…¬å¼
â”‚   â”œâ”€â”€ Testing_and_Usage_Guide.md        # æµ‹è¯•ä¸ä½¿ç”¨æŒ‡å—
â”‚   â””â”€â”€ Performance_Analysis_RTX3060.md      # æ€§èƒ½åˆ†ææ–‡æ¡£
â”‚
â”œâ”€â”€ demo/                           # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ network.py                    # ç½‘ç»œå®ç°
â”‚   â”œâ”€â”€ physics.py                    # ç‰©ç†è®¡ç®—
â”‚   â”œâ”€â”€ mcmc.py                       # MCMC é‡‡æ ·å™¨
â”‚   â”œâ”€â”€ trainer.py                    # è®­ç»ƒå™¨
â”‚   â”œâ”€â”€ configs/                      # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ train_*.py                   # è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ test_*.py                    # æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ performance_test.py            # æ€§èƒ½æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ physics_optimized.py         # ä¼˜åŒ–çš„ç‰©ç†è®¡ç®—ï¼ˆå¾…å®Œæˆï¼‰
â”‚
â””â”€â”€ results/                        # è®­ç»ƒç»“æœ
    â”œâ”€â”€ stage1/                      # Stage 1 ç»“æœ
    â””â”€â”€ stage2/                      # Stage 2 ç»“æœ
```

---

## ğŸ”— å¿«é€Ÿé“¾æ¥

### æ¦‚å¿µä¸ç†è®º
- [æ³¢å‡½æ•°ç†è®º](./Algorithms_and_Formulas.md#1-æ³¢å‡½æ•°ç†è®º)
- [èƒ½é‡å…¬å¼](./Algorithms_and_Formulas.md#2-èƒ½é‡å…¬å¼)
- [å˜åˆ†åŸç†](./Algorithms_and_Formulas.md#3-å˜åˆ†åŸç†)

### å®ç°
- [SimpleFermiNet ç±»](./Stage1_Complete_Documentation.md#2-ç½‘ç»œæ¶æ„networkpy)
- [ExtendedFermiNet ç±»](./Stage2_Complete_Documentation.md#2-æ‰©å±•ç½‘ç»œæ¶æ„networkxpy)
- [å¤šè¡Œåˆ—å¼å®ç°](./Stage2_Complete_Documentation.md#3-å¤šè¡Œåˆ—å¼å®ç°)
- [æ®‹å·®è¿æ¥](./Stage2_Complete_Documentation.md#5-æ®‹å·®å±‚)

### è®­ç»ƒä¸ä¼˜åŒ–
- [VMC è®­ç»ƒå™¨](./Stage1_Complete_Documentation.md#5-è®­ç»ƒå™¨trainerpy)
- [Adam ä¼˜åŒ–å™¨](./Algorithms_and_Formulas.md#5-ä¼˜åŒ–ç®—æ³•)
- [å­¦ä¹ ç‡è°ƒåº¦](./Stage2_Complete_Documentation.md#6-å­¦ä¹ ç‡è°ƒåº¦å™¨)
- [æ¢¯åº¦è£å‰ª](./Stage2_Complete_Documentation.md#7-æ‰©å±•è®­ç»ƒå™¨trainerxpy)

### å®ç”¨æŒ‡å—
- [è¿è¡Œç¬¬ä¸€ä¸ªè®­ç»ƒ](./Testing_and_Usage_Guide.md#1-å…¥é—¨)
- [è¶…å‚æ•°è°ƒä¼˜](./Testing_and_Usage_Guide.md#3-è®­ç»ƒæŒ‡å—)
- [è°ƒè¯•æŠ€å·§](./Testing_and_Usage_Guide.md#4-è°ƒè¯•æŒ‡å—)
- [ç»“æœåˆ†æ](./Testing_and_Usage_Guide.md#5-ç»“æœåˆ†æ)

### æ€§èƒ½ä¼˜åŒ– â­ é‡è¦
- [æ€§èƒ½åˆ†ææŠ¥å‘Š](./Performance_Analysis_RTX3060.md) - å½“å‰æ€§èƒ½ç“¶é¢ˆåˆ†æ
- [ä¼˜åŒ–æ–¹æ¡ˆ](./Performance_Analysis_RTX3060.md#-ä¼˜åŒ–æ–¹æ¡ˆï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰
- [é¢„æœŸæ€§èƒ½æå‡](./Performance_Analysis_RTX3060.md#-é¢„æœŸæ€§èƒ½æå‡æ•°æ®ï¼‰

---

## ğŸ“š é™„åŠ èµ„æº

### å‚è€ƒè®ºæ–‡
1. **FermiNeuT åŸå§‹è®ºæ–‡**ï¼šPfau et al., Nature Communications, 2020
   - https://www.nature.com/articles/s41567-020-01238-z

2. **æ·±åº¦å­¦ä¹ é‡å­åŒ–å­¦ç»¼è¿°**ï¼švon Lilienfeld et al., Chemical Reviews, 2020
   - https://pubs.acs.org/doi/10.1021/acs.chemrev.9b03007

### åœ¨çº¿æ–‡æ¡£
- **JAX å®˜æ–¹æ–‡æ¡£**ï¼šhttps://jax.readthedocs.io/
- **NumPy æ–‡æ¡£**ï¼šhttps://numpy.org/doc/
- **é‡å­è’™ç‰¹å¡æ´›å‚è€ƒ**ï¼šhttps://github.com/QMCSoftware/QMCPACK

### å¼€æºé¡¹ç›®
- **DeepMind FermiNeuT**ï¼šhttps://github.com/deepmind/deepmind-research/tree/master/ferminet
- **PySCFï¼ˆé‡å­åŒ–å­¦åº“ï¼‰**ï¼šhttps://github.com/pyscf/pyscf

---

## ğŸ“ æ–‡æ¡£ç‰ˆæœ¬ä¿¡æ¯

- **æ–‡æ¡£ç‰ˆæœ¬**ï¼š2.0
- **æœ€åæ›´æ–°**ï¼š2026-01-29
- **å¯¹åº”ä»£ç ç‰ˆæœ¬**ï¼šStage 1 (å®Œæˆ)ï¼ŒStage 2 (æ ¸å¿ƒå®Œæˆ)ï¼Œæ€§èƒ½ä¼˜åŒ–(è¿›è¡Œä¸­)
- **ç»´æŠ¤è€…**ï¼šFermiNeuT å¼€å‘å›¢é˜Ÿ

---

## ğŸ’¬ è”ç³»ä¸åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥é˜…æœ¬æ–‡æ¡£åº“ä¸­çš„ç›¸å…³ç« èŠ‚
2. è¿è¡Œæµ‹è¯•è„šæœ¬è¯Šæ–­é—®é¢˜
3. å‚è€ƒ [æµ‹è¯•ä¸ä½¿ç”¨æŒ‡å—](./Testing_and_Usage_Guide.md) çš„è°ƒè¯•ç« èŠ‚
4. å¦‚æœé‡åˆ°æ€§èƒ½é—®é¢˜ï¼Œå‚è€ƒ [æ€§èƒ½åˆ†æ](./Performance_Analysis_RTX3060.md)
5. æäº¤ Issue åˆ°é¡¹ç›®ä»“åº“

---

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–çŠ¶æ€

### å½“å‰æ€§èƒ½
- **å®æµ‹é€Ÿåº¦**ï¼šæ¯ä¸ª epoch ~150 ç§’ï¼ˆ2.5 åˆ†é’Ÿï¼‰
- **ç†è®ºç›®æ ‡**ï¼šæ¯ä¸ª epoch 0.5-1 ç§’
- **æ€§èƒ½å·®è·**ï¼š150-300å€

### ä¸»è¦ç“¶é¢ˆ
1. âš ï¸ **èƒ½é‡è®¡ç®—**ï¼š1000x æ€§èƒ½æŸå¤±
   - åŸå› ï¼šåµŒå¥—å¾ªç¯ä¸­é‡å¤ JIT ç¼–è¯‘
   - ä¼˜å…ˆçº§ï¼šğŸ”´ğŸ”´ğŸ”´ æœ€é«˜

2. âš ï¸ **Python å¾ªç¯**ï¼š10-50x æ€§èƒ½æŸå¤±
   - åŸå› ï¼šæœªä½¿ç”¨ vmap å¹¶è¡ŒåŒ–
   - ä¼˜å…ˆçº§ï¼šğŸ”´ğŸ”´ é«˜

3. âš ï¸ **å°æ‰¹æ¬¡**ï¼š2-5x æ€§èƒ½æŸå¤±
   - åŸå› ï¼š128 æ ·æœ¬å¯¹ GPU å¤ªå°
   - ä¼˜å…ˆçº§ï¼šğŸ”´ğŸ”´ é«˜

### ä¼˜åŒ–æ–¹æ¡ˆ
1. ä½¿ç”¨ JAX Hessian ä¸€æ¬¡è®¡ç®—äºŒé˜¶å¯¼æ•°
2. ä½¿ç”¨ jax.vmap æ‰¹é‡å¹¶è¡Œè®¡ç®—
3. å¢å¤§æ‰¹æ¬¡åˆ° 256-512
4. JIT ç¼–è¯‘æ‰€æœ‰å…³é”®å‡½æ•°
5. ä½¿ç”¨ float32 èŠ‚çœå†…å­˜

### é¢„æœŸç»“æœ
- **å®æ–½ä¼˜åŒ–å**ï¼šæ¯ä¸ª epoch 0.5-1 ç§’
- **æ€»æå‡**ï¼š150-300x
- **10 epochs æ—¶é—´**ï¼š5-10 ç§’ï¼ˆè€Œä¸æ˜¯ 25 åˆ†é’Ÿï¼‰

---

**ğŸ‰ æ„Ÿè°¢ï¼é˜…è¯» FermiNeuT å®æ•´å®ç°æ–‡æ¡£ï¼**
